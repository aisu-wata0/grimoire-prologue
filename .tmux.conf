# https://github.com/brantb/dotfiles/blob/master/tmux.conf

# # Set prefix to Ctrl-Space
# unbind C-b
# set -g prefix  C-Space
set -g prefix2 C-Space
# bind C-Space send-prefix -2
# bind Space send-prefix
# set -g prefix2 C-a                        # GNU-Screen compatible prefix

# -- navigation ----------------------------------------------------------------

# Mouse support
set -g mouse on

# bind -n [keys] [command]
# This binds the keys without needing the prefix
# bind -r [keys] [command]
# So you can use multiple times with one prefix

# # Manage windows
bind -n C-t new-window
bind C-t new-window

bind k confirm kill-pane

# # window navigation
# #
bind-key -n C-e next-window
bind-key -n C-w previous-window
# bind-key -n C-w last-window        # move to last active window

bind-key -r Tab last-window        # move to last active window

# # Doest work
# bind-key -n C-Tab last-window        # move to last active window

# unbind n
# unbind p

# split panes using [ and ]
bind-key -n C-[ split-window -h
bind-key -n C-] split-window -v
bind-key C-[ split-window -h
bind-key C-] split-window -v
# unbind '"'
# unbind %


# # Pane navigation
bind -r C-j select-pane -L  # move left
bind -r C-l select-pane -R  # move right
bind -r C-i select-pane -U  # move up
bind -r C-k select-pane -D  # move down
# # # switch panes using Alt-arrow no prefix
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

bind -r > swap-pane -D       # swap current pane with the next one
bind -r < swap-pane -U       # swap current pane with the previous one

# Swap stuff with nums
# https://github.com/gotbletu/shownotes/blob/master/tmux_choose_tree_interactively.md
bind-key C-M-w command-prompt -p "Swap Current Window To? (e.g 3; 4; session_name:5)" "swap-window -t '%%'"
bind-key C-M-p command-prompt -p "Swap Current Pane To? (e.g 2.0; session_name:4.0)" "swap-pane -t '%%'"
bind-key M-p command-prompt -p "Move Current Pane To? (e.g 3.1; session_name:6.0)" "move-pane -t '%%'"

# -- extra binds -------------------------------------------------------------------

# Reload config file
bind r source-file ~/.tmux.conf \; display-message "Configuration reloaded."


# -- cfg -------------------------------------------------------------------

# set scrollback history 
set -g history-limit 10000

# set window and pane index to 1 (0 by default)
set-option -g base-index 1
setw -g pane-base-index 1

# -- display -------------------------------------------------------------------

set -g renumber-windows on    # renumber windows when a window is closed


set -g status-interval 2     # redraw status line every X seconds

# Show activity in background windows
setw -g monitor-activity on

# expect UTF-8 (tmux < 2.2)
set -q -g status-utf8 on
setw -q -g utf8 on

# 256 color support
set -g default-terminal "screen-256color"

# -- Theme -------------------------------------------------------------------

# https://github.com/jimeh/tmux-themepack/blob/master/powerline/double/magenta.tmuxtheme
##
# Powerline Double Magenta - Tmux Theme
# Created by Jim Myhrberg <contact@jimeh.me>.
#
# Inspired by vim-powerline: https://github.com/Lokaltog/powerline
#
# Requires terminal to be using a powerline compatible font, find one here:
# https://github.com/Lokaltog/powerline-fonts
#

# Status update interval
# set -g status-interval 1

# Basic status bar colors
set -g status-style fg=colour240,bg=colour233

# Left side of status bar
set -g status-left-style bg=colour233,fg=colour243
set -g status-left-length 40
set -g status-left "#[fg=colour233,bg=colour125,bold] #S #[fg=colour125,bg=colour240,nobold]#[fg=colour233,bg=colour240] #(whoami) #[fg=colour240,bg=colour235]#[fg=colour240,bg=colour235] #I:#P #[fg=colour235,bg=colour233,nobold]"

# Right side of status bar
set -g status-right-style bg=colour233,fg=colour243
set -g status-right-length 150
set -g status-right "#[fg=colour235,bg=colour233]#[fg=colour240,bg=colour235] %H:%M:%S #[fg=colour240,bg=colour235]#[fg=colour233,bg=colour240] %d-%b-%y #[fg=colour125,bg=colour240]#[fg=colour233,bg=colour125,bold] #H "

# Window status
set -g window-status-format "  #I:#W#F  "
set -g window-status-current-format "#[fg=colour233,bg=black]#[fg=colour129,nobold] #I:#W#F #[fg=colour233,bg=black,nobold]"

# Current window status
set -g window-status-current-style bg=colour125,fg=colour235

# Window with activity status
set -g window-status-activity-style bg=colour233,fg=colour245

# Window separator
set -g window-status-separator ""

# Window status alignment
set -g status-justify centre

# Pane border
set -g pane-border-style bg=default,fg=colour238

# Active pane border
set -g pane-active-border-style bg=default,fg=colour125

# Pane number indicator
set -g display-panes-colour colour233
set -g display-panes-active-colour colour245

# Clock mode
set -g clock-mode-colour colour125
set -g clock-mode-style 24

# Message
set -g message-style bg=colour125,fg=black

# Command message
set -g message-command-style bg=colour233,fg=black

# Mode
set -g mode-style bg=colour125,fg=colour231


# -- Theme -------------------------------------------------------------------

# Update window title
# set -g set-titles on
# set -g set-titles-string '#T - #I:#W'

# rename window to reflect current state
set-option -g automatic-rename on
set-option -g automatic-rename-format  "#{?pane_in_mode,[tmux],#{b:pane_current_path}:#{pane_current_command}}#{?pane_dead,[dead],}"
# Default:
# set-option -g automatic-rename-format  "#{?pane_in_mode,[tmux],#{pane_current_command}}#{?pane_dead,[dead],}"